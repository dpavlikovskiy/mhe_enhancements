function getAnchorPosition(a){var b=new Object,c=0,d=0,e=!1,f=!1,g=!1;if(document.getElementById?e=!0:document.all?f=!0:document.layers&&(g=!0),e&&document.all)c=AnchorPosition_getPageOffsetLeft(document.all[a]),d=AnchorPosition_getPageOffsetTop(document.all[a]);else if(e){var h=document.getElementById(a);c=AnchorPosition_getPageOffsetLeft(h),d=AnchorPosition_getPageOffsetTop(h)}else if(f)c=AnchorPosition_getPageOffsetLeft(document.all[a]),d=AnchorPosition_getPageOffsetTop(document.all[a]);else{if(!g)return b.x=0,b.y=0,b;for(var i=0,j=0;j<document.anchors.length;j++)if(document.anchors[j].name==a){i=1;break}if(0==i)return b.x=0,b.y=0,b;c=document.anchors[j].x,d=document.anchors[j].y}return b.x=c,b.y=d,b}function getAnchorWindowPosition(a){var b=getAnchorPosition(a),c=0,d=0;return document.getElementById?isNaN(window.screenX)?(c=b.x-document.body.scrollLeft+window.screenLeft,d=b.y-document.body.scrollTop+window.screenTop):(c=b.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset,d=b.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset):document.all?(c=b.x-document.body.scrollLeft+window.screenLeft,d=b.y-document.body.scrollTop+window.screenTop):document.layers&&(c=b.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset,d=b.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset),b.x=c,b.y=d,b}function AnchorPosition_getPageOffsetLeft(a){for(var b=a.offsetLeft;null!=(a=a.offsetParent);)b+=a.offsetLeft;return b}function AnchorPosition_getWindowOffsetLeft(a){return AnchorPosition_getPageOffsetLeft(a)-document.body.scrollLeft}function AnchorPosition_getPageOffsetTop(a){for(var b=a.offsetTop;null!=(a=a.offsetParent);)b+=a.offsetTop;return b}function AnchorPosition_getWindowOffsetTop(a){return AnchorPosition_getPageOffsetTop(a)-document.body.scrollTop}function LZ(a){return(0>a||a>9?"":"0")+a}function isDate(a,b){var c=getDateFromFormat(a,b);return 0!=c}function compareDates(a,b,c,d){var e=getDateFromFormat(a,b),f=getDateFromFormat(c,d);return 0==e||0==f?-1:e>f?1:0}function formatDate(a,b){b+="";var c,d="",e=0,f="",g="",h=a.getYear()+"",i=a.getMonth()+1,j=a.getDate(),k=a.getDay(),c=a.getHours(),l=a.getMinutes(),m=a.getSeconds(),n=new Object;for(h.length<4&&(h=""+(h-0+1900)),n.y=""+h,n.yyyy=h,n.yy=h.substring(2,4),n.M=i,n.MM=LZ(i),n.MMM=MONTH_NAMES[i-1],n.NNN=MONTH_NAMES[i+11],n.d=j,n.dd=LZ(j),n.E=DAY_NAMES[k+7],n.EE=DAY_NAMES[k],n.H=c,n.HH=LZ(c),0==c?n.h=12:c>12?n.h=c-12:n.h=c,n.hh=LZ(n.h),c>11?n.K=c-12:n.K=c,n.k=c+1,n.KK=LZ(n.K),n.kk=LZ(n.k),c>11?n.a="PM":n.a="AM",n.m=l,n.mm=LZ(l),n.s=m,n.ss=LZ(m);e<b.length;){for(f=b.charAt(e),g="";b.charAt(e)==f&&e<b.length;)g+=b.charAt(e++);d+=null!=n[g]?n[g]:g}return d}function _isInteger(a){for(var b="1234567890",c=0;c<a.length;c++)if(-1==b.indexOf(a.charAt(c)))return!1;return!0}function _getInt(a,b,c,d){for(var e=d;e>=c;e--){var f=a.substring(b,b+e);if(f.length<c)return null;if(_isInteger(f))return f}return null}function getDateFromFormat(a,b){a+="",b+="";for(var c,d,e=0,f=0,g="",h="",i=new Date,j=i.getYear(),k=i.getMonth()+1,l=1,m=i.getHours(),n=i.getMinutes(),o=i.getSeconds(),p="";f<b.length;){for(g=b.charAt(f),h="";b.charAt(f)==g&&f<b.length;)h+=b.charAt(f++);if("yyyy"==h||"yy"==h||"y"==h){if("yyyy"==h&&(c=4,d=4),"yy"==h&&(c=2,d=2),"y"==h&&(c=2,d=4),j=_getInt(a,e,c,d),null==j)return 0;e+=j.length,2==j.length&&(j=j>70?1900+(j-0):2e3+(j-0))}else if("MMM"==h||"NNN"==h){k=0;for(var q=0;q<MONTH_NAMES.length;q++){var r=MONTH_NAMES[q];if(a.substring(e,e+r.length).toLowerCase()==r.toLowerCase()&&("MMM"==h||"NNN"==h&&q>11)){k=q+1,k>12&&(k-=12),e+=r.length;break}}if(1>k||k>12)return 0}else if("EE"==h||"E"==h)for(var q=0;q<DAY_NAMES.length;q++){var s=DAY_NAMES[q];if(a.substring(e,e+s.length).toLowerCase()==s.toLowerCase()){e+=s.length;break}}else if("MM"==h||"M"==h){if(k=_getInt(a,e,h.length,2),null==k||1>k||k>12)return 0;e+=k.length}else if("dd"==h||"d"==h){if(l=_getInt(a,e,h.length,2),null==l||1>l||l>31)return 0;e+=l.length}else if("hh"==h||"h"==h){if(m=_getInt(a,e,h.length,2),null==m||1>m||m>12)return 0;e+=m.length}else if("HH"==h||"H"==h){if(m=_getInt(a,e,h.length,2),null==m||0>m||m>23)return 0;e+=m.length}else if("KK"==h||"K"==h){if(m=_getInt(a,e,h.length,2),null==m||0>m||m>11)return 0;e+=m.length}else if("kk"==h||"k"==h){if(m=_getInt(a,e,h.length,2),null==m||1>m||m>24)return 0;e+=m.length,m--}else if("mm"==h||"m"==h){if(n=_getInt(a,e,h.length,2),null==n||0>n||n>59)return 0;e+=n.length}else if("ss"==h||"s"==h){if(o=_getInt(a,e,h.length,2),null==o||0>o||o>59)return 0;e+=o.length}else if("a"==h){if("am"==a.substring(e,e+2).toLowerCase())p="AM";else{if("pm"!=a.substring(e,e+2).toLowerCase())return 0;p="PM"}e+=2}else{if(a.substring(e,e+h.length)!=h)return 0;e+=h.length}}if(e!=a.length)return 0;if(2==k)if(j%4==0&&j%100!=0||j%400==0){if(l>29)return 0}else if(l>28)return 0;if((4==k||6==k||9==k||11==k)&&l>30)return 0;12>m&&"PM"==p?m=m-0+12:m>11&&"AM"==p&&(m-=12);var t=new Date(j,k-1,l,m,n,o);return t.getTime()}function parseDate(a){var b=2==arguments.length?arguments[1]:!1;generalFormats=new Array("y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"),monthFirst=new Array("M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"),dateFirst=new Array("d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M");for(var c=new Array("generalFormats",b?"dateFirst":"monthFirst",b?"monthFirst":"dateFirst"),d=null,e=0;e<c.length;e++)for(var f=window[c[e]],g=0;g<f.length;g++)if(d=getDateFromFormat(a,f[g]),0!=d)return new Date(d);return null}function PopupWindow_getXYPosition(a){var b;b="WINDOW"==this.type?getAnchorWindowPosition(a):getAnchorPosition(a),this.x=b.x,this.y=b.y}function PopupWindow_setSize(a,b){this.width=a,this.height=b}function PopupWindow_populate(a){this.contents=a,this.populated=!1}function PopupWindow_setUrl(a){this.url=a}function PopupWindow_setWindowProperties(a){this.windowProperties=a}function PopupWindow_refresh(){if(null!=this.divName){if(this.use_gebi)document.getElementById(this.divName).innerHTML=this.contents;else if(this.use_css)document.all[this.divName].innerHTML=this.contents;else if(this.use_layers){var a=document.layers[this.divName];a.document.open(),a.document.writeln(this.contents),a.document.close()}}else null==this.popupWindow||this.popupWindow.closed||(""!=this.url?this.popupWindow.location.href=this.url:(this.popupWindow.document.open(),this.popupWindow.document.writeln(this.contents),this.popupWindow.document.close()),this.popupWindow.focus())}function PopupWindow_showPopup(a){if(this.getXYPosition(a),this.x+=this.offsetX,this.y+=this.offsetY,this.populated||""==this.contents||(this.populated=!0,this.refresh()),null!=this.divName)this.use_gebi?(document.getElementById(this.divName).style.left=this.x+"px",document.getElementById(this.divName).style.top=this.y+"px",document.getElementById(this.divName).style.visibility="visible"):this.use_css?(document.all[this.divName].style.left=this.x,document.all[this.divName].style.top=this.y,document.all[this.divName].style.visibility="visible"):this.use_layers&&(document.layers[this.divName].left=this.x,document.layers[this.divName].top=this.y,document.layers[this.divName].visibility="visible");else{if(null==this.popupWindow||this.popupWindow.closed){this.x<0&&(this.x=0),this.y<0&&(this.y=0),screen&&screen.availHeight&&this.y+this.height>screen.availHeight&&(this.y=screen.availHeight-this.height),screen&&screen.availWidth&&this.x+this.width>screen.availWidth&&(this.x=screen.availWidth-this.width);var b=window.opera||document.layers&&!navigator.mimeTypes["*"]||"KDE"==navigator.vendor||document.childNodes&&!document.all&&!navigator.taintEnabled;this.popupWindow=window.open(b?"":"about:blank","window_"+a,this.windowProperties+",width="+this.width+",height="+this.height+",screenX="+this.x+",left="+this.x+",screenY="+this.y+",top="+this.y)}this.refresh()}}function PopupWindow_hidePopup(){null!=this.divName?this.use_gebi?document.getElementById(this.divName).style.visibility="hidden":this.use_css?document.all[this.divName].style.visibility="hidden":this.use_layers&&(document.layers[this.divName].visibility="hidden"):this.popupWindow&&!this.popupWindow.closed&&(this.popupWindow.close(),this.popupWindow=null)}function PopupWindow_isClicked(a){if(null!=this.divName){if(this.use_layers){var b=a.pageX,c=a.pageY,d=document.layers[this.divName];return b>d.left&&b<d.left+d.clip.width&&c>d.top&&c<d.top+d.clip.height}if(document.all){for(var d=window.event.srcElement;null!=d.parentElement;){if(d.id==this.divName)return!0;d=d.parentElement}return!1}if(this.use_gebi&&a){for(var d=a.originalTarget;null!=d.parentNode;){if(d.id==this.divName)return!0;d=d.parentNode}return!1}return!1}return!1}function PopupWindow_hideIfNotClicked(a){this.autoHideEnabled&&!this.isClicked(a)&&this.hidePopup()}function PopupWindow_autoHide(){this.autoHideEnabled=!0}function PopupWindow_hidePopupWindows(a){for(var b=0;b<popupWindowObjects.length;b++)if(null!=popupWindowObjects[b]){var c=popupWindowObjects[b];c.hideIfNotClicked(a)}}function PopupWindow_attachListener(){document.layers&&document.captureEvents(Event.MOUSEUP),window.popupWindowOldEventListener=document.onmouseup,null!=window.popupWindowOldEventListener?document.onmouseup=new Function("window.popupWindowOldEventListener();PopupWindow_hidePopupWindows();"):document.onmouseup=PopupWindow_hidePopupWindows}function PopupWindow(){window.popupWindowIndex||(window.popupWindowIndex=0),window.popupWindowObjects||(window.popupWindowObjects=new Array),window.listenerAttached||(window.listenerAttached=!0,PopupWindow_attachListener()),this.index=popupWindowIndex++,popupWindowObjects[this.index]=this,this.divName=null,this.popupWindow=null,this.width=0,this.height=0,this.populated=!1,this.visible=!1,this.autoHideEnabled=!1,this.contents="",this.url="",this.windowProperties="toolbar=no,location=no,status=no,menubar=no,scrollbars=auto,resizable,alwaysRaised,dependent,titlebar=no",arguments.length>0?(this.type="DIV",this.divName=arguments[0]):this.type="WINDOW",this.use_gebi=!1,this.use_css=!1,this.use_layers=!1,document.getElementById?this.use_gebi=!0:document.all?this.use_css=!0:document.layers?this.use_layers=!0:this.type="WINDOW",this.offsetX=0,this.offsetY=0,this.getXYPosition=PopupWindow_getXYPosition,this.populate=PopupWindow_populate,this.setUrl=PopupWindow_setUrl,this.setWindowProperties=PopupWindow_setWindowProperties,this.refresh=PopupWindow_refresh,this.showPopup=PopupWindow_showPopup,this.hidePopup=PopupWindow_hidePopup,this.setSize=PopupWindow_setSize,this.isClicked=PopupWindow_isClicked,this.autoHide=PopupWindow_autoHide,this.hideIfNotClicked=PopupWindow_hideIfNotClicked}function CalendarPopup(){var a;return arguments.length>0?a=new PopupWindow(arguments[0]):(a=new PopupWindow,a.setSize(150,175)),a.offsetX=-152,a.offsetY=25,a.autoHide(),a.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),a.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),a.dayHeaders=new Array("S","M","T","W","T","F","S"),a.returnFunction="CP_tmpReturnFunction",a.returnMonthFunction="CP_tmpReturnMonthFunction",a.returnQuarterFunction="CP_tmpReturnQuarterFunction",a.returnYearFunction="CP_tmpReturnYearFunction",a.weekStartDay=0,a.isShowYearNavigation=!1,a.displayType="date",a.disabledWeekDays=new Object,a.disabledDatesExpression="",a.yearSelectStartOffset=2,a.currentDate=null,a.todayText="Today",a.cssPrefix="",a.isShowNavigationDropdowns=!1,a.isShowYearNavigationInput=!1,window.CP_calendarObject=null,window.CP_targetInput=null,window.CP_dateFormat="MM/dd/yyyy",a.copyMonthNamesToWindow=CP_copyMonthNamesToWindow,a.setReturnFunction=CP_setReturnFunction,a.setReturnMonthFunction=CP_setReturnMonthFunction,a.setReturnQuarterFunction=CP_setReturnQuarterFunction,a.setReturnYearFunction=CP_setReturnYearFunction,a.setMonthNames=CP_setMonthNames,a.setMonthAbbreviations=CP_setMonthAbbreviations,a.setDayHeaders=CP_setDayHeaders,a.setWeekStartDay=CP_setWeekStartDay,a.setDisplayType=CP_setDisplayType,a.setDisabledWeekDays=CP_setDisabledWeekDays,a.addDisabledDates=CP_addDisabledDates,a.setYearSelectStartOffset=CP_setYearSelectStartOffset,a.setTodayText=CP_setTodayText,a.showYearNavigation=CP_showYearNavigation,a.showCalendar=CP_showCalendar,a.hideCalendar=CP_hideCalendar,a.getStyles=getCalendarStyles,a.refreshCalendar=CP_refreshCalendar,a.getCalendar=CP_getCalendar,a.select=CP_select,a.setCssPrefix=CP_setCssPrefix,a.showNavigationDropdowns=CP_showNavigationDropdowns,a.showYearNavigationInput=CP_showYearNavigationInput,a.copyMonthNamesToWindow(),a}function CP_copyMonthNamesToWindow(){if("undefined"!=typeof window.MONTH_NAMES&&null!=window.MONTH_NAMES){window.MONTH_NAMES=new Array;for(var a=0;a<this.monthNames.length;a++)window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthNames[a];for(var a=0;a<this.monthAbbreviations.length;a++)window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthAbbreviations[a]}}function CP_tmpReturnFunction(a,b,c){if(null!=window.CP_targetInput){var d=new Date(a,b-1,c,0,0,0);null!=window.CP_calendarObject&&window.CP_calendarObject.copyMonthNamesToWindow(),window.CP_targetInput.value=formatDate(d,window.CP_dateFormat)}else alert("Use setReturnFunction() to define which function will get the clicked results!")}function CP_tmpReturnMonthFunction(a,b){alert("Use setReturnMonthFunction() to define which function will get the clicked results!\nYou clicked: year="+a+" , month="+b)}function CP_tmpReturnQuarterFunction(a,b){alert("Use setReturnQuarterFunction() to define which function will get the clicked results!\nYou clicked: year="+a+" , quarter="+b)}function CP_tmpReturnYearFunction(a){alert("Use setReturnYearFunction() to define which function will get the clicked results!\nYou clicked: year="+a)}function CP_setReturnFunction(a){this.returnFunction=a}function CP_setReturnMonthFunction(a){this.returnMonthFunction=a}function CP_setReturnQuarterFunction(a){this.returnQuarterFunction=a}function CP_setReturnYearFunction(a){this.returnYearFunction=a}function CP_setMonthNames(){for(var a=0;a<arguments.length;a++)this.monthNames[a]=arguments[a];this.copyMonthNamesToWindow()}function CP_setMonthAbbreviations(){for(var a=0;a<arguments.length;a++)this.monthAbbreviations[a]=arguments[a];this.copyMonthNamesToWindow()}function CP_setDayHeaders(){for(var a=0;a<arguments.length;a++)this.dayHeaders[a]=arguments[a]}function CP_setWeekStartDay(a){this.weekStartDay=a}function CP_showYearNavigation(){this.isShowYearNavigation=arguments.length>0?arguments[0]:!0}function CP_setDisplayType(a){return"date"!=a&&"week-end"!=a&&"month"!=a&&"quarter"!=a&&"year"!=a?(alert("Invalid display type! Must be one of: date,week-end,month,quarter,year"),!1):void(this.displayType=a)}function CP_setYearSelectStartOffset(a){this.yearSelectStartOffset=a}function CP_setDisabledWeekDays(){this.disabledWeekDays=new Object;for(var a=0;a<arguments.length;a++)this.disabledWeekDays[arguments[a]]=!0}function CP_addDisabledDates(a,b){1==arguments.length&&(b=a),null==a&&null==b||(""!=this.disabledDatesExpression&&(this.disabledDatesExpression+="||"),null!=a&&(a=parseDate(a),a=""+a.getFullYear()+LZ(a.getMonth()+1)+LZ(a.getDate())),null!=b&&(b=parseDate(b),b=""+b.getFullYear()+LZ(b.getMonth()+1)+LZ(b.getDate())),null==a?this.disabledDatesExpression+="(ds<="+b+")":null==b?this.disabledDatesExpression+="(ds>="+a+")":this.disabledDatesExpression+="(ds>="+a+"&&ds<="+b+")")}function CP_setTodayText(a){this.todayText=a}function CP_setCssPrefix(a){this.cssPrefix=a}function CP_showNavigationDropdowns(){this.isShowNavigationDropdowns=arguments.length>0?arguments[0]:!0}function CP_showYearNavigationInput(){this.isShowYearNavigationInput=arguments.length>0?arguments[0]:!0}function CP_hideCalendar(){arguments.length>0?window.popupWindowObjects[arguments[0]].hidePopup():this.hidePopup()}function CP_refreshCalendar(a){var b=window.popupWindowObjects[a];arguments.length>1?b.populate(b.getCalendar(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])):b.populate(b.getCalendar()),b.refresh()}function CP_showCalendar(a){arguments.length>1&&(null==arguments[1]||""==arguments[1]?this.currentDate=new Date:this.currentDate=new Date(parseDate(arguments[1]))),this.populate(this.getCalendar()),this.showPopup(a)}function CP_select(a,b,c){var d=arguments.length>3?arguments[3]:null;if(!window.getDateFromFormat)return void alert("calendar.select: To use this method you must also include 'date.js' for date formatting");if("date"!=this.displayType&&"week-end"!=this.displayType)return void alert("calendar.select: This function can only be used with displayType 'date' or 'week-end'");if("text"!=a.type&&"hidden"!=a.type&&"textarea"!=a.type)return alert("calendar.select: Input object passed is not a valid form input object"),void(window.CP_targetInput=null);if(!a.disabled){window.CP_targetInput=a,window.CP_calendarObject=this,this.currentDate=null;var e=0;null!=d?e=getDateFromFormat(d,c):""!=a.value&&(e=getDateFromFormat(a.value,c)),null==d&&""==a.value||(0==e?this.currentDate=null:this.currentDate=new Date(e)),window.CP_dateFormat=c,this.showCalendar(b)}}function getCalendarStyles(){var a="",b="";return null!=this&&"undefined"!=typeof this.cssPrefix&&null!=this.cssPrefix&&""!=this.cssPrefix&&(b=this.cssPrefix),a+="<STYLE>\n",a+="."+b+"cpYearNavigation,."+b+"cpMonthNavigation{background-color:#C0C0C0;text-align:center;vertical-align:center;text-decoration:none;color:#000000;font-weight:bold;}\n",a+="."+b+"cpDayColumnHeader, ."+b+"cpYearNavigation,."+b+"cpMonthNavigation,."+b+"cpCurrentMonthDate,."+b+"cpCurrentMonthDateDisabled,."+b+"cpOtherMonthDate,."+b+"cpOtherMonthDateDisabled,."+b+"cpCurrentDate,."+b+"cpCurrentDateDisabled,."+b+"cpTodayText,."+b+"cpTodayTextDisabled,."+b+"cpText{font-family:arial;font-size:8pt;}\n",a+="TD."+b+"cpDayColumnHeader{text-align:right;border:solid thin #C0C0C0;border-width:0px 0px 1px 0px;}\n",a+="."+b+"cpCurrentMonthDate, ."+b+"cpOtherMonthDate, ."+b+"cpCurrentDate{text-align:right;text-decoration:none;}\n",a+="."+b+"cpCurrentMonthDateDisabled, ."+b+"cpOtherMonthDateDisabled, ."+b+"cpCurrentDateDisabled{color:#D0D0D0;text-align:right;text-decoration:line-through;}\n",a+="."+b+"cpCurrentMonthDate, .cpCurrentDate{color:#000000;}\n",a+="."+b+"cpOtherMonthDate{color:#808080;}\n",a+="TD."+b+"cpCurrentDate{color:white;background-color: #C0C0C0;border-width:1px;border:solid thin #800000;}\n",a+="TD."+b+"cpCurrentDateDisabled{border-width:1px;border:solid thin #FFAAAA;}\n",a+="TD."+b+"cpTodayText, TD."+b+"cpTodayTextDisabled{border:solid thin #C0C0C0;border-width:1px 0px 0px 0px;}\n",a+="A."+b+"cpTodayText, SPAN."+b+"cpTodayTextDisabled{height:20px;}\n",a+="A."+b+"cpTodayText{color:black;}\n",a+="."+b+"cpTodayTextDisabled{color:#D0D0D0;}\n",a+="."+b+"cpBorder{border:solid thin #808080;}\n",a+="</STYLE>\n"}function CP_getCalendar(){var now=new Date;if("WINDOW"==this.type)var windowref="window.opener.";else var windowref="";var result="";if("WINDOW"==this.type?(result+="<HTML><HEAD><TITLE>Calendar</TITLE>"+this.getStyles()+"</HEAD><BODY MARGINWIDTH=0 MARGINHEIGHT=0 TOPMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0>\n",result+="<CENTER><TABLE WIDTH=100% BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>\n"):(result+='<TABLE CLASS="'+this.cssPrefix+'cpBorder" WIDTH=144 BORDER=1 BORDERWIDTH=1 CELLSPACING=0 CELLPADDING=1>\n',result+="<TR><TD ALIGN=CENTER>\n",result+="<CENTER>\n"),"date"==this.displayType||"week-end"==this.displayType){if(null==this.currentDate&&(this.currentDate=now),arguments.length>0)var month=arguments[0];else var month=this.currentDate.getMonth()+1;if(arguments.length>1&&arguments[1]>0&&arguments[1]-0==arguments[1])var year=arguments[1];else var year=this.currentDate.getFullYear();var daysinmonth=new Array(0,31,28,31,30,31,30,31,31,30,31,30,31);(year%4==0&&year%100!=0||year%400==0)&&(daysinmonth[2]=29);var current_month=new Date(year,month-1,1),display_year=year,display_month=month,display_date=1,weekday=current_month.getDay(),offset=0;offset=weekday>=this.weekStartDay?weekday-this.weekStartDay:7-this.weekStartDay+weekday,offset>0&&(display_month--,1>display_month&&(display_month=12,display_year--),display_date=daysinmonth[display_month]-offset+1);var next_month=month+1,next_month_year=year;next_month>12&&(next_month=1,next_month_year++);var last_month=month-1,last_month_year=year;1>last_month&&(last_month=12,last_month_year--);var date_class;"WINDOW"!=this.type&&(result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>"),result+="<TR>\n";var refresh=windowref+"CP_refreshCalendar",refreshLink="javascript:"+refresh;if(this.isShowNavigationDropdowns){result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="78" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpMonthNavigation" name="cpMonth" onChange="'+refresh+"("+this.index+",this.options[this.selectedIndex].value-0,"+(year-0)+');">';for(var monthCounter=1;12>=monthCounter;monthCounter++){var selected=monthCounter==month?"SELECTED":"";result+='<option value="'+monthCounter+'" '+selected+">"+this.monthNames[monthCounter-1]+"</option>"}result+="</select></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>',result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="56" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpYearNavigation" name="cpYear" onChange="'+refresh+"("+this.index+","+month+',this.options[this.selectedIndex].value-0);">';for(var yearCounter=year-this.yearSelectStartOffset;yearCounter<=year+this.yearSelectStartOffset;yearCounter++){var selected=yearCounter==year?"SELECTED":"";result+='<option value="'+yearCounter+'" '+selected+">"+yearCounter+"</option>"}result+="</select></TD>"}else this.isShowYearNavigation?(result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+last_month+","+last_month_year+');">&lt;</A></TD>',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="58"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+"</SPAN></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+next_month+","+next_month_year+');">&gt;</A></TD>',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>',result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+"("+this.index+","+month+","+(year-1)+');">&lt;</A></TD>',result+=this.isShowYearNavigationInput?'<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><INPUT NAME="cpYear" CLASS="'+this.cssPrefix+'cpYearNavigation" SIZE="4" MAXLENGTH="4" VALUE="'+year+'" onBlur="'+refresh+"("+this.index+","+month+',this.value-0);"></TD>':'<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><SPAN CLASS="'+this.cssPrefix+'cpYearNavigation">'+year+"</SPAN></TD>",result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+"("+this.index+","+month+","+(year+1)+');">&gt;</A></TD>'):(result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+last_month+","+last_month_year+');">&lt;&lt;</A></TD>\n',result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="100"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+" "+year+"</SPAN></TD>\n",result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+"("+this.index+","+next_month+","+next_month_year+');">&gt;&gt;</A></TD>\n');result+="</TR></TABLE>\n",result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=0 CELLPADDING=1 ALIGN=CENTER>\n",result+="<TR>\n";for(var j=0;7>j;j++)result+='<TD CLASS="'+this.cssPrefix+'cpDayColumnHeader" WIDTH="14%"><SPAN CLASS="'+this.cssPrefix+'cpDayColumnHeader">'+this.dayHeaders[(this.weekStartDay+j)%7]+"</TD>\n";result+="</TR>\n";for(var row=1;6>=row;row++){result+="<TR>\n";for(var col=1;7>=col;col++){var disabled=!1;if(""!=this.disabledDatesExpression){var ds=""+display_year+LZ(display_month)+LZ(display_date);eval("disabled=("+this.disabledDatesExpression+")")}var dateClass="";if(dateClass=display_month==this.currentDate.getMonth()+1&&display_date==this.currentDate.getDate()&&display_year==this.currentDate.getFullYear()?"cpCurrentDate":display_month==month?"cpCurrentMonthDate":"cpOtherMonthDate",disabled||this.disabledWeekDays[col-1])result+='	<TD CLASS="'+this.cssPrefix+dateClass+'"><SPAN CLASS="'+this.cssPrefix+dateClass+'Disabled">'+display_date+"</SPAN></TD>\n";else{var selected_date=display_date,selected_month=display_month,selected_year=display_year;if("week-end"==this.displayType){var d=new Date(selected_year,selected_month-1,selected_date,0,0,0,0);d.setDate(d.getDate()+(7-col)),selected_year=d.getYear(),1e3>selected_year&&(selected_year+=1900),selected_month=d.getMonth()+1,selected_date=d.getDate()}result+='	<TD CLASS="'+this.cssPrefix+dateClass+'"><A HREF="javascript:'+windowref+this.returnFunction+"("+selected_year+","+selected_month+","+selected_date+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+this.cssPrefix+dateClass+'">'+display_date+"</A></TD>\n"}display_date++,display_date>daysinmonth[display_month]&&(display_date=1,display_month++),display_month>12&&(display_month=1,display_year++)}result+="</TR>"}var current_weekday=now.getDay()-this.weekStartDay;if(0>current_weekday&&(current_weekday+=7),result+="<TR>\n",result+='	<TD COLSPAN=7 ALIGN=CENTER CLASS="'+this.cssPrefix+'cpTodayText">\n',""!=this.disabledDatesExpression){var ds=""+now.getFullYear()+LZ(now.getMonth()+1)+LZ(now.getDate());eval("disabled=("+this.disabledDatesExpression+")")}result+=disabled||this.disabledWeekDays[current_weekday+1]?'		<SPAN CLASS="'+this.cssPrefix+'cpTodayTextDisabled">'+this.todayText+"</SPAN>\n":'		<A CLASS="'+this.cssPrefix+'cpTodayText" HREF="javascript:'+windowref+this.returnFunction+"('"+now.getFullYear()+"','"+(now.getMonth()+1)+"','"+now.getDate()+"');"+windowref+"CP_hideCalendar('"+this.index+"');\">"+this.todayText+"</A>\n",result+="		<BR>\n",result+="	</TD></TR></TABLE></CENTER></TD></TR></TABLE>\n"}if("month"==this.displayType||"quarter"==this.displayType||"year"==this.displayType){if(arguments.length>0)var year=arguments[0];else if("year"==this.displayType)var year=now.getFullYear()-this.yearSelectStartOffset;else var year=now.getFullYear();"year"!=this.displayType&&this.isShowYearNavigation&&(result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>",result+="<TR>\n",result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year-1)+');">&lt;&lt;</A></TD>\n',result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="100">'+year+"</TD>\n",result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year+1)+');">&gt;&gt;</A></TD>\n',result+="</TR></TABLE>\n")}if("month"==this.displayType){result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;4>i;i++){result+="<TR>";for(var j=0;3>j;j++){var monthindex=3*i+j;result+='<TD WIDTH=33% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnMonthFunction+"("+year+","+(monthindex+1)+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">'+this.monthAbbreviations[monthindex]+"</A></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}if("quarter"==this.displayType){result+="<BR><TABLE WIDTH=120 BORDER=1 CELLSPACING=0 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;2>i;i++){result+="<TR>";for(var j=0;2>j;j++){var quarter=2*i+j+1;result+='<TD WIDTH=50% ALIGN=CENTER><BR><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnQuarterFunction+"("+year+","+quarter+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">Q'+quarter+"</A><BR><BR></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}if("year"==this.displayType){var yearColumnSize=4;result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>",result+="<TR>\n",result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year-2*yearColumnSize)+');">&lt;&lt;</A></TD>\n',result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+"CP_refreshCalendar("+this.index+","+(year+2*yearColumnSize)+');">&gt;&gt;</A></TD>\n',result+="</TR></TABLE>\n",result+="<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n";for(var i=0;yearColumnSize>i;i++){for(var j=0;2>j;j++){var currentyear=year+j*yearColumnSize+i;result+='<TD WIDTH=50% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnYearFunction+"("+currentyear+");"+windowref+"CP_hideCalendar('"+this.index+'\');" CLASS="'+date_class+'">'+currentyear+"</A></TD>"}result+="</TR>"}result+="</TABLE></CENTER></TD></TR></TABLE>\n"}return"WINDOW"==this.type&&(result+="</BODY></HTML>\n"),result}var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");