!function(a){function b(b,c){this.el=b,this.defaults={visibleClass:"sort-by-visible",selectID:"grid-sort",containerClass:"sort-by",selectorClass:"sbSelector"},this.options=a.extend({},this.defaults,c),this.iOS=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),this.touch=window.Modernizr.touch,this.init()}b.prototype={init:function(){this.initSelectors(),!this.touch||this.iOS?this.customSelect():this.standardSelect()},initSelectors:function(){this.select=this.el.find("#"+this.options.selectID),this.container=this.el.find("."+this.options.containerClass),this.label=this.el.find("label[for="+this.options.selectID+"]")},customSelect:function(){function b(b){var c=b.find("option").filter(":selected"),d=b.next().find("li"),e=d.filter(function(){return a(this).find("a").text()===c.text()?this:void 0});d.show().filter(e).hide()}this.select.selectbox({onChange:function(a,c){b(c.input),window.location=a}}),this.container.addClass(this.options.visibleClass),this.el.find("."+this.options.selectorClass).prepend(this.label.text()+" "),b(this.select)},standardSelect:function(){this.select.css("display","inline-block"),this.label.css("display","inline-block"),this.container.addClass(this.options.visibleClass)}},a.fn.sortOptions=function(c){return this.each(function(){a(this).data().sortOptions=new b(a(this),c)})}}(jQuery);