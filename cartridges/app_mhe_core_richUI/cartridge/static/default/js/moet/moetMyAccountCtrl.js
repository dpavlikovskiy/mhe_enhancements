$(document).ready(function(){window.myAccountCtrl={$personalDetails:$("#js-personal-details"),$orderHistory:$("ul.js-order-history"),$changePassword:$("#js-change-password"),$savedCards:$("#js-saved-cards"),$addCards:$("#js-add-card"),$savedAddresses:$("#js-saved-addresses"),$addAddress:$("#js-add-address"),$addAddress2:$("#fiscaldiv"),init:function(){1===this.$personalDetails.length&&this.initPersonalDetails(this.$personalDetails),1===this.$changePassword.length&&this.initChangePassword(this.$changePassword),1===this.$savedCards.length&&this.initSavedCards(this.$savedCards),1===this.$addCards.length&&this.initAddCards(this.$addCards),1===this.$savedAddresses.length&&this.initSavedAddresses(this.$savedAddresses),1===this.$addAddress.length&&this.initAddAddress(this.$addAddress),1===this.$orderHistory.length&&this.initOrderHistory(this.$orderHistory),1===this.$addAddress2.length&&this.initAddAddress2(this.$addAddress2)},initPersonalDetails:function(a){a.find("select").addClass("custom-select").uniform()},initOrderHistory:function(a){var b=this;a.find("h3.order-show-details").on("click",function(){var a=$(this).data("orderUrl"),c=$(this).attr("data-order-no");$(this).hasClass("collapsed")?(b.getOrderDetails(c,a),$(this).removeClass("collapsed").addClass("expanded")):($(this).addClass("collapsed").removeClass("expanded"),b.hideOrderDetails(c,a))})},getOrderDetails:function(a,b){var c=$("#span"+a);$.ajax({dataType:"html",url:window.app.util.appendParamToURL(b,"orderId",a)}).done(function(a){c.html("<div class='order-ajax-inner'>"+a+"</div>").addClass("order-ajax-visible"),c.css({height:c.find(".order-ajax-inner").height()})})},hideOrderDetails:function(a,b){var c=$("#span"+a);c.css({height:0})},initChangePassword:function(a){function b(){var a=e.find(".account-form").outerHeight();e.addClass("password-fields-visible").height(a),e.one("webkitTransitionEnd otransitionend msTransitionEnd transitionend",function(b){e.css({"min-height":a+"px",height:"auto"})})}function c(){var a=!1;f.each(function(){$(this).val()&&(a=!0)}),a?(f.addClass("password-input"),h.addClass("password-repeat")):(f.removeClass("password-input"),h.removeClass("password-repeat"))}var d=$("#js-new-password-subtitle").text(),e=(a.find(".input-text-pw"),$("#js-password-fields")),f=e.find("input.input-text-pw").not("#dwfrm_profile_login_oldpassword"),g=a.find($("#dwfrm_profile_login_password")),h=a.find($("#dwfrm_profile_login_passwordconfirm"));a.find(".form-row:eq(2) label").addClass("subtitled").append("<br><span class='subtitle'>"+d+"</span>"),a.find("button").on("click",function(){b()}),a.data("expanded")&&b(),g.addClass("new-pass"),f.on("focusout",function(){c()})},initSavedCards:function(a){},initAddCards:function(a){var b=a.find(".account-cards label"),c=a.find("input[type=radio]");a.find("input[type=radio]:checked").siblings("label").addClass("active"),a.find("select").addClass("custom-select").uniform(),c.on("click",function(){b.removeClass("active"),$(this).siblings("label").addClass("active")}),b.on("click",function(){c.trigger("click")})},initSavedAddresses:function(a){var b=a.find(".address-default label"),c=$("input:radio[name=defaultCheck]");c.on("click",function(){window.location.href=window.app.util.appendParamToURL(app.urls.setDefaultAddressUrl,"AddressID",encodeURIComponent($(this).val()))}),b.on("click",function(){$(this).siblings("input[type=radio]").trigger("click")})},initAddAddress:function(a){a.find("select").addClass("custom-select").uniform()},initAddAddress2:function(a){var b=($("#vatNumberRadio"),$("#fiscalCodeRadio"),$(".companyName")),c=b.find("input");$("body").on("click","#vatNumberRadio",function(){b.addClass("required"),c.addClass("required")}),$("body").on("click","#fiscalCodeRadio",function(){b.removeClass("required form-row-valid form-row-error"),c.removeClass("required"),b.find(".error").remove()}),$(document).ajaxComplete(function(){var a=($("#vatNumberRadio"),$("#fiscalCodeRadio"),$(".companyName")),b=a.find("input");$("body").on("click","#vatNumberRadio",function(){a.addClass("required"),b.addClass("required")}),$("body").on("click","#fiscalCodeRadio",function(){a.removeClass("required form-row-valid form-row-error"),b.removeClass("required"),a.find(".error").remove()})})}},myAccountCtrl.init()});